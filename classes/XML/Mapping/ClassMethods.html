<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: XML::Mapping::ClassMethods</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href="../../.././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">XML::Mapping::ClassMethods</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../../../files/lib/xml/mapping/base_rb.html">
                lib/xml/mapping/base.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
The instance methods of this module are automatically added as class
methods to a class that includes <a
href="../Mapping.html">XML::Mapping</a>.
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000029">add_accessor</a>&nbsp;&nbsp;
      <a href="#M000033">all_xml_mapping_nodes</a>&nbsp;&nbsp;
      <a href="#M000028">default_mapping</a>&nbsp;&nbsp;
      <a href="#M000035">default_root_element_name</a>&nbsp;&nbsp;
      <a href="#M000030">load_from_file</a>&nbsp;&nbsp;
      <a href="#M000031">load_from_xml</a>&nbsp;&nbsp;
      <a href="#M000034">root_element_name</a>&nbsp;&nbsp;
      <a href="#M000027">use_mapping</a>&nbsp;&nbsp;
      <a href="#M000032">xml_mapping_nodes</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->

    <div id="section">





      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000029" class="method-detail">
        <a name="M000029"></a>

        <div class="method-heading">
          <a href="#M000029" class="method-signature">
          <span class="method-name">add_accessor</span><span class="method-args">(name)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Add getter and setter methods for a new attribute named <em>name</em> to
this class. This is a convenience method intended to be called from <a
href="Node.html">Node</a> class initializers.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000029-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000029-source">
<pre>
     <span class="ruby-comment cmt"># File lib/xml/mapping/base.rb, line 298</span>
298:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_accessor</span>(<span class="ruby-identifier">name</span>)
299:         <span class="ruby-identifier">name</span> = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">id2name</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">kind_of?</span> <span class="ruby-constant">Symbol</span>
300:         <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_methods</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">name</span>)
301:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">module_eval</span> <span class="ruby-value str">&quot;attr_reader :\#{name}\n&quot;</span>
302:         <span class="ruby-keyword kw">end</span>
303:         <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance_methods</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-node">&quot;#{name}=&quot;</span>)
304:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">module_eval</span> <span class="ruby-value str">&quot;attr_writer :\#{name}\n&quot;</span>
305:         <span class="ruby-keyword kw">end</span>
306:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000033" class="method-detail">
        <a name="M000033"></a>

        <div class="method-heading">
          <a href="#M000033" class="method-signature">
          <span class="method-name">all_xml_mapping_nodes</span><span class="method-args">(options={:mapping=&gt;nil})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
enumeration of all nodes in effect when marshalling/unmarshalling this
class, that is, nodes defined for this class as well as for its
superclasses. The nodes are returned in the order of their definition,
starting with the topmost superclass that has nodes defined. Option
arguments are the same as for <a
href="ClassMethods.html#M000032">xml_mapping_nodes</a>.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000033-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000033-source">
<pre>
     <span class="ruby-comment cmt"># File lib/xml/mapping/base.rb, line 355</span>
355:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">all_xml_mapping_nodes</span>(<span class="ruby-identifier">options</span>={<span class="ruby-identifier">:mapping=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">nil</span>})
356:         <span class="ruby-comment cmt"># TODO: we could return a dynamic Enumerable here, or cache</span>
357:         <span class="ruby-comment cmt"># the array...</span>
358:         <span class="ruby-identifier">result</span> = []
359:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">superclass</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">:all_xml_mapping_nodes</span>)
360:           <span class="ruby-identifier">result</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">all_xml_mapping_nodes</span> <span class="ruby-identifier">options</span>
361:         <span class="ruby-keyword kw">end</span>
362:         <span class="ruby-identifier">result</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">xml_mapping_nodes</span> <span class="ruby-identifier">options</span>
363:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000028" class="method-detail">
        <a name="M000028"></a>

        <div class="method-heading">
          <a href="#M000028" class="method-signature">
          <span class="method-name">default_mapping</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
return the current default mapping (:_default initially, or the value set
with the latest call to <a
href="ClassMethods.html#M000027">use_mapping</a>)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000028-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000028-source">
<pre>
     <span class="ruby-comment cmt"># File lib/xml/mapping/base.rb, line 291</span>
291:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_mapping</span>
292:         <span class="ruby-ivar">@default_mapping</span>
293:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000035" class="method-detail">
        <a name="M000035"></a>

        <div class="method-heading">
          <a href="#M000035" class="method-signature">
          <span class="method-name">default_root_element_name</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The default root element name for this class. Equals the class name, with
all parent module names stripped, and with capital letters converted to
lowercase and preceded by a dash; e.g. &quot;Foo::Bar::MySampleClass&quot;
becomes &quot;my-sample-class&quot;.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000035-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000035-source">
<pre>
     <span class="ruby-comment cmt"># File lib/xml/mapping/base.rb, line 396</span>
396:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_root_element_name</span>
397:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">name</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'::'</span>)[<span class="ruby-value">-1</span>].<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^(.)/</span>){<span class="ruby-identifier">$1</span>.<span class="ruby-identifier">downcase</span>}.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/(.)([A-Z])/</span>){<span class="ruby-identifier">$1</span><span class="ruby-operator">+</span><span class="ruby-value str">&quot;-&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">$2</span>.<span class="ruby-identifier">downcase</span>}
398:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000030" class="method-detail">
        <a name="M000030"></a>

        <div class="method-heading">
          <a href="#M000030" class="method-signature">
          <span class="method-name">load_from_file</span><span class="method-args">(filename, options={:mapping=&gt;:_default})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create a new instance of this class from the <a
href="../../XML.html">XML</a> contained in the file named
<em>filename</em>. Calls <a
href="ClassMethods.html#M000031">load_from_xml</a> internally.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000030-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000030-source">
<pre>
     <span class="ruby-comment cmt"># File lib/xml/mapping/base.rb, line 316</span>
316:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_from_file</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">options</span>={<span class="ruby-identifier">:mapping=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">:_default</span>})
317:         <span class="ruby-identifier">xml</span> = <span class="ruby-constant">REXML</span><span class="ruby-operator">::</span><span class="ruby-constant">Document</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">filename</span>))
318:         <span class="ruby-identifier">load_from_xml</span> <span class="ruby-identifier">xml</span>.<span class="ruby-identifier">root</span>, <span class="ruby-identifier">:mapping=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">options</span>[<span class="ruby-identifier">:mapping</span>]
319:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000031" class="method-detail">
        <a name="M000031"></a>

        <div class="method-heading">
          <a href="#M000031" class="method-signature">
          <span class="method-name">load_from_xml</span><span class="method-args">(xml, options={:mapping=&gt;:_default})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Create a new instance of this class from the <a
href="../../XML.html">XML</a> contained in <em>xml</em> (a REXML::Element).
</p>
<p>
Allocates a new object, then calls fill_from_xml(<em>xml</em>) on it.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000031-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000031-source">
<pre>
     <span class="ruby-comment cmt"># File lib/xml/mapping/base.rb, line 326</span>
326:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">load_from_xml</span>(<span class="ruby-identifier">xml</span>, <span class="ruby-identifier">options</span>={<span class="ruby-identifier">:mapping=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">:_default</span>})
327:         <span class="ruby-identifier">raise</span>(<span class="ruby-constant">MappingError</span>, <span class="ruby-node">&quot;undefined mapping: #{options[:mapping].inspect}&quot;</span>) \
328:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">xml_mapping_nodes_hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:mapping</span>])
329:         <span class="ruby-identifier">obj</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">allocate</span>
330:         <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">initialize_xml_mapping</span> <span class="ruby-identifier">:mapping=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">options</span>[<span class="ruby-identifier">:mapping</span>]
331:         <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">fill_from_xml</span> <span class="ruby-identifier">xml</span>, <span class="ruby-identifier">:mapping=</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">options</span>[<span class="ruby-identifier">:mapping</span>]
332:         <span class="ruby-identifier">obj</span>
333:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000034" class="method-detail">
        <a name="M000034"></a>

        <div class="method-heading">
          <a href="#M000034" class="method-signature">
          <span class="method-name">root_element_name</span><span class="method-args">(name=nil, options={:mapping=&gt;@default_mapping})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
The &quot;root element name&quot; of this class (combined getter/setter
method).
</p>
<p>
The root element name is the name of the root element of the <a
href="../../XML.html">XML</a> tree returned by &lt;this
class&gt;.save_to_xml (or, more specifically, &lt;this class&gt;.pre_save).
By default, this method returns the <a
href="ClassMethods.html#M000035">default_root_element_name</a>; you may
call this method with an argument to set the root element name to something
other than the default. The option argument :mapping specifies the mapping
the root element is/will be defined in, it defaults to the current default
mapping (:_default initially, or the value set with the latest call to <a
href="ClassMethods.html#M000027">use_mapping</a>)
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000034-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000034-source">
<pre>
     <span class="ruby-comment cmt"># File lib/xml/mapping/base.rb, line 379</span>
379:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">root_element_name</span>(<span class="ruby-identifier">name</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">options</span>={<span class="ruby-identifier">:mapping=</span><span class="ruby-operator">&gt;</span><span class="ruby-ivar">@default_mapping</span>})
380:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Hash</span><span class="ruby-operator">===</span><span class="ruby-identifier">name</span>    <span class="ruby-comment cmt"># ugly...</span>
381:           <span class="ruby-identifier">options</span>=<span class="ruby-identifier">name</span>; <span class="ruby-identifier">name</span>=<span class="ruby-keyword kw">nil</span>
382:         <span class="ruby-keyword kw">end</span>
383:         <span class="ruby-ivar">@root_element_names</span> <span class="ruby-operator">||=</span> {}
384:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>
385:           <span class="ruby-constant">Classes_by_rootelt_names</span>.<span class="ruby-identifier">remove_class</span> <span class="ruby-identifier">root_element_name</span>, <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:mapping</span>], <span class="ruby-keyword kw">self</span>
386:           <span class="ruby-ivar">@root_element_names</span>[<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:mapping</span>]] = <span class="ruby-identifier">name</span>
387:           <span class="ruby-constant">Classes_by_rootelt_names</span>.<span class="ruby-identifier">create_classes_for</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:mapping</span>]) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>
388:         <span class="ruby-keyword kw">end</span>
389:         <span class="ruby-ivar">@root_element_names</span>[<span class="ruby-identifier">options</span>[<span class="ruby-identifier">:mapping</span>]] <span class="ruby-operator">||</span> <span class="ruby-identifier">default_root_element_name</span>
390:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000027" class="method-detail">
        <a name="M000027"></a>

        <div class="method-heading">
          <a href="#M000027" class="method-signature">
          <span class="method-name">use_mapping</span><span class="method-args">(mapping)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Make <em>mapping</em> the mapping to be used by default in future node
declarations in this class. The default can be overwritten on a per-node
basis by passing a :mapping option parameter to the node factory method
</p>
<p>
The initial default mapping in a mapping class is :_default
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000027-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000027-source">
<pre>
     <span class="ruby-comment cmt"># File lib/xml/mapping/base.rb, line 282</span>
282:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">use_mapping</span> <span class="ruby-identifier">mapping</span>
283:         <span class="ruby-ivar">@default_mapping</span> = <span class="ruby-identifier">mapping</span>
284:         <span class="ruby-identifier">xml_mapping_nodes_hash</span>[<span class="ruby-identifier">mapping</span>] <span class="ruby-operator">||=</span> []  <span class="ruby-comment cmt"># create empty mapping node list if</span>
285:                                                 <span class="ruby-comment cmt"># there wasn't one before so future calls</span>
286:                                                 <span class="ruby-comment cmt"># to load/save_xml etc. w/ this mapping don't raise</span>
287:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000032" class="method-detail">
        <a name="M000032"></a>

        <div class="method-heading">
          <a href="#M000032" class="method-signature">
          <span class="method-name">xml_mapping_nodes</span><span class="method-args">(options={:mapping=&gt;nil})</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
array of all nodes defined in this class, in the order of their definition.
Option :mapping specifies the mapping the returned nodes must have been
defined in; nil means return all nodes regardless of their mapping
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000032-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000032-source">
<pre>
     <span class="ruby-comment cmt"># File lib/xml/mapping/base.rb, line 340</span>
340:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">xml_mapping_nodes</span>(<span class="ruby-identifier">options</span>={<span class="ruby-identifier">:mapping=</span><span class="ruby-operator">&gt;</span><span class="ruby-keyword kw">nil</span>})
341:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">nil</span><span class="ruby-operator">==</span><span class="ruby-identifier">options</span>[<span class="ruby-identifier">:mapping</span>]
342:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">xml_mapping_nodes_hash</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">flatten</span>
343:         <span class="ruby-keyword kw">end</span>
344:         <span class="ruby-identifier">mapping</span> = <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:mapping</span>] <span class="ruby-operator">||</span> <span class="ruby-ivar">@default_mapping</span>
345:         <span class="ruby-identifier">xml_mapping_nodes_hash</span>[<span class="ruby-identifier">mapping</span>] <span class="ruby-operator">||=</span> []
346:       <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>